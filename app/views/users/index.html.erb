<h1>All about meâ€¦</h1>

<h2>Data</h2>
<p>name: <%= @user.name %></p>
<p>email: <%= @user.email %></p>

<% friends = @user.friends %>
<% unless friends.empty? %>
  <h2>Friends</h2>
  <% friends.each do |friend| %>
    <p><%= link_to friend.name, :controller => 'users', :action => 'show', :name => friend.name %></p>
  <% end %>
<% end %>

<% incoming = @user.friendships_as_consumer.select{|f| !f.confirmed?} %>
<% outgoing = @user.friendships_as_initiator.select{|f| !f.confirmed?} %>
<% unless [incoming, outgoing].empty? %>
  <h3>Requests</h3>
  <% unless incoming.empty? %>
    <h4>Incoming</h4>
    <% incoming.each do |friendship| %>
      <p>From <%= friendship.initiator.name %>, requested at <%= friendship.created_at %></p>
        <%= form_for friendship, :url => { :action => "confirm_friendship", :id => friendship.id } do |f| %>
          <%= f.submit "Confirm" %>
        <% end %>
    <% end %>
  <% end %>
  <% unless outgoing.empty? %>
    <h4>Outgoing</h4>
    <% outgoing.each do |friendship| %>
      <p>To <%= friendship.consumer.name %>, requested at <%= friendship.created_at %></p>
    <% end %>
  <% end %>
<% end %>
